"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1945],{1945:(x,P,d)=>{d.r(P),d.d(P,{PaymentMethodsPageModule:()=>E});var _=d(177),l=d(4341),r=d(4742),p=d(4964),h=d(467),t=d(3953),C=d(8287),O=d(1182);function y(a,m){1&a&&t.nrm(0,"ion-spinner",13)}function b(a,m){if(1&a){const c=t.RV6();t.j41(0,"ion-card",16)(1,"div",17),t.nrm(2,"div",18),t.j41(3,"div",19)(4,"div",20)(5,"ion-chip",21),t.EFF(6),t.k0s()(),t.j41(7,"div",22),t.EFF(8),t.k0s(),t.j41(9,"div",23)(10,"div",24)(11,"span",25),t.EFF(12,"Titular"),t.k0s(),t.j41(13,"span",26),t.EFF(14),t.k0s()(),t.j41(15,"div",27)(16,"span",25),t.EFF(17,"Expira"),t.k0s(),t.j41(18,"span",26),t.EFF(19),t.k0s()()()(),t.j41(20,"div",28)(21,"ion-button",29),t.bIt("click",function(){const i=t.eBV(c).$implicit,g=t.XpG(2);return t.Njj(g.deletePaymentMethod(i.id))}),t.nrm(22,"ion-icon",30),t.k0s()()()()}if(2&a){const c=m.$implicit;t.xc7("animation-delay",.1*m.index+"s"),t.R7$(5),t.Y8G("color","debit"===c.type?"success":"primary"),t.R7$(),t.SpI(" ","debit"===c.type?"D\xe9bito":"Cr\xe9dito"," "),t.R7$(2),t.SpI("**** **** **** ",c.lastFourDigits,""),t.R7$(6),t.JRh(c.cardHolderName),t.R7$(5),t.JRh(c.expirationDate)}}function u(a,m){if(1&a&&(t.j41(0,"div",14),t.DNE(1,b,23,7,"ion-card",15),t.k0s()),2&a){const c=t.XpG();t.R7$(),t.Y8G("ngForOf",c.paymentMethods)}}function f(a,m){1&a&&(t.j41(0,"div",52),t.EFF(1," Nombre del titular es requerido "),t.k0s())}function v(a,m){1&a&&(t.j41(0,"div",52),t.EFF(1," Ingrese 4 d\xedgitos v\xe1lidos "),t.k0s())}function e(a,m){1&a&&(t.j41(0,"div",52),t.EFF(1," Fecha de expiraci\xf3n inv\xe1lida "),t.k0s())}function n(a,m){if(1&a){const c=t.RV6();t.j41(0,"div",31)(1,"h2"),t.EFF(2,"Agregar nuevo m\xe9todo de pago"),t.k0s(),t.j41(3,"div",32),t.nrm(4,"div",33),t.j41(5,"div",34),t.nrm(6,"ion-icon",35),t.k0s(),t.j41(7,"div",22),t.EFF(8),t.k0s(),t.j41(9,"div",19)(10,"div")(11,"label"),t.EFF(12,"TITULAR"),t.k0s(),t.j41(13,"p"),t.EFF(14),t.k0s()(),t.j41(15,"div")(16,"label"),t.EFF(17,"EXPIRA"),t.k0s(),t.j41(18,"p"),t.EFF(19),t.k0s()()(),t.j41(20,"div",20),t.EFF(21),t.k0s()(),t.j41(22,"form",36),t.bIt("ngSubmit",function(){t.eBV(c);const i=t.XpG();return t.Njj(i.addPaymentMethod())}),t.j41(23,"ion-item",37)(24,"ion-label",38),t.EFF(25,"Nombre del titular"),t.k0s(),t.nrm(26,"ion-input",39),t.k0s(),t.DNE(27,f,2,0,"div",40),t.j41(28,"div",41)(29,"ion-segment",42)(30,"ion-segment-button",43)(31,"ion-label"),t.EFF(32,"Cr\xe9dito"),t.k0s()(),t.j41(33,"ion-segment-button",44)(34,"ion-label"),t.EFF(35,"D\xe9bito"),t.k0s()()()(),t.j41(36,"ion-item",37)(37,"ion-label",38),t.EFF(38,"\xdaltimos 4 d\xedgitos"),t.k0s(),t.nrm(39,"ion-input",45),t.k0s(),t.DNE(40,v,2,0,"div",40),t.j41(41,"ion-item",37)(42,"ion-label",38),t.EFF(43,"Fecha de expiraci\xf3n"),t.k0s(),t.nrm(44,"ion-input",46),t.k0s(),t.DNE(45,e,2,0,"div",40),t.j41(46,"div",47)(47,"ion-button",48),t.bIt("click",function(){t.eBV(c);const i=t.XpG();return t.Njj(i.isAddPaymentMethodModalOpen=!1)}),t.nrm(48,"ion-icon",49),t.j41(49,"span"),t.EFF(50,"Cancelar"),t.k0s()(),t.j41(51,"ion-button",50),t.nrm(52,"ion-icon",51),t.j41(53,"span"),t.EFF(54,"Agregar tarjeta"),t.k0s()()()()()}if(2&a){let c,o,i,g;const s=t.XpG();t.R7$(8),t.SpI("**** **** **** ",(null==(c=s.paymentMethodForm.get("lastFourDigits"))?null:c.value)||"****",""),t.R7$(6),t.JRh((null==(o=s.paymentMethodForm.get("cardHolderName"))?null:o.value)||"NOMBRE DEL TITULAR"),t.R7$(5),t.JRh((null==(i=s.paymentMethodForm.get("expirationDate"))?null:i.value)||"MM/YY"),t.R7$(2),t.SpI(" ","credit"===(null==(g=s.paymentMethodForm.get("type"))?null:g.value)?"CR\xc9DITO":"D\xc9BITO"," "),t.R7$(),t.Y8G("formGroup",s.paymentMethodForm),t.R7$(5),t.Y8G("ngIf",(null==s.cardHolderName?null:s.cardHolderName.touched)&&(null==s.cardHolderName?null:s.cardHolderName.invalid)),t.R7$(13),t.Y8G("ngIf",(null==s.lastFourDigits?null:s.lastFourDigits.touched)&&(null==s.lastFourDigits?null:s.lastFourDigits.invalid)),t.R7$(5),t.Y8G("ngIf",(null==s.expirationDate?null:s.expirationDate.touched)&&(null==s.expirationDate?null:s.expirationDate.invalid)),t.R7$(6),t.Y8G("disabled",!s.paymentMethodForm.valid)}}const F=[{path:"",component:(()=>{var a;class m{constructor(o,i,g,s,D,j){this.formBuilder=o,this.firebaseService=i,this.alertController=g,this.toastController=s,this.afAuth=D,this.router=j,this.paymentMethods=[],this.isLoading=!1,this.isAddPaymentMethodModalOpen=!1,this.showSuccessMessage=!1,this.paymentMethodForm=this.formBuilder.group({cardHolderName:["",[l.k0.required,l.k0.minLength(3)]],type:["credit",l.k0.required],lastFourDigits:["",[l.k0.required,l.k0.pattern(/^[0-9]{4}$/)]],expirationDate:["",[l.k0.required,l.k0.pattern(/^(0[1-9]|1[0-2])\/([0-9]{2})$/)]]})}ngOnInit(){this.afAuth.authState.subscribe(o=>{o?(console.log("Usuario autenticado en PaymentMethodsPage:",o.uid),this.loadPaymentMethods()):(console.log("No hay usuario autenticado en PaymentMethodsPage"),this.router.navigate(["/login"]))})}loadPaymentMethods(){this.isLoading=!0,console.log("Iniciando carga de m\xe9todos de pago en la p\xe1gina"),this.firebaseService.getPaymentMethods().subscribe(o=>{console.log("M\xe9todos de pago recibidos en la p\xe1gina:",o),this.paymentMethods=o,this.isLoading=!1,0===o.length&&console.log("No se encontraron m\xe9todos de pago para este usuario")},o=>{console.error("Error al cargar los m\xe9todos de pago:",o),this.isLoading=!1})}showAddPaymentMethodModal(){this.isAddPaymentMethodModalOpen=!0}addPaymentMethod(){if(this.paymentMethodForm.valid){const o={...this.paymentMethodForm.value,isDefault:0===this.paymentMethods.length};this.firebaseService.addPaymentMethod(o).subscribe(()=>{this.isAddPaymentMethodModalOpen=!1,this.showSuccessMessage=!0,this.loadPaymentMethods(),setTimeout(()=>{this.showSuccessMessage=!1},3e3)},i=>{console.error("Error al agregar m\xe9todo de pago:",i),this.presentToast("Error al agregar m\xe9todo de pago","danger")})}}deletePaymentMethod(o){o&&this.alertController.create({header:"\xbfEst\xe1s seguro?",message:"\xbfQuieres eliminar esta tarjeta?",buttons:[{text:"Cancelar",role:"cancel"},{text:"Eliminar",handler:()=>{this.firebaseService.deletePaymentMethod(o).subscribe(()=>{this.presentToast("Tarjeta eliminada con \xe9xito"),this.loadPaymentMethods()},i=>{console.error("Error al eliminar la tarjeta:",i),this.presentToast("Error al eliminar la tarjeta","danger")})}}]}).then(i=>i.present())}setDefaultPaymentMethod(o){var i=this;return(0,h.A)(function*(){const g=i.paymentMethods.map(s=>i.firebaseService.updatePaymentMethod(s.id,{isDefault:!1}));g.push(i.firebaseService.updatePaymentMethod(o,{isDefault:!0})),Promise.all(g).then(()=>i.presentToast("M\xe9todo de pago predeterminado actualizado")).catch(s=>{console.error("Error al actualizar m\xe9todo de pago predeterminado:",s),i.presentToast("Error al actualizar m\xe9todo de pago predeterminado","danger")})})()}presentToast(o,i="success"){var g=this;return(0,h.A)(function*(){(yield g.toastController.create({message:o,duration:2e3,color:i})).present()})()}getCardBrand(o){return"Tarjeta"}get cardHolderName(){return this.paymentMethodForm.get("cardHolderName")}get lastFourDigits(){return this.paymentMethodForm.get("lastFourDigits")}get expirationDate(){return this.paymentMethodForm.get("expirationDate")}}return(a=m).\u0275fac=function(o){return new(o||a)(t.rXU(l.ok),t.rXU(C.f),t.rXU(r.hG),t.rXU(r.K_),t.rXU(O.DS),t.rXU(p.Ix))},a.\u0275cmp=t.VBU({type:a,selectors:[["app-payment-methods"]],decls:22,vars:6,consts:[[1,"ion-no-border"],["slot","start"],["defaultHref","/dashboard","text",""],["class","loading-spinner",4,"ngIf"],["class","payment-methods-container",4,"ngIf"],["vertical","bottom","horizontal","end","slot","fixed"],[1,"animate__animated","animate__bounceIn",3,"click"],["name","add"],[1,"add-payment-method-modal",3,"didDismiss","isOpen"],["message","Procesando...","spinner","crescent",3,"isOpen"],[1,"success-message"],[1,"success-icon"],["name","checkmark-circle-outline"],[1,"loading-spinner"],[1,"payment-methods-container"],["class","payment-card animate__animated animate__fadeInUp",3,"animation-delay",4,"ngFor","ngForOf"],[1,"payment-card","animate__animated","animate__fadeInUp"],[1,"card-content"],[1,"card-background"],[1,"card-info"],[1,"card-type"],[3,"color"],[1,"card-number"],[1,"card-details"],[1,"card-holder"],[1,"label"],[1,"value"],[1,"card-expiry"],[1,"card-actions"],["fill","clear",3,"click"],["name","trash-outline"],[1,"modal-content"],[1,"card-preview"],[1,"chip"],[1,"card-icon"],["name","card-outline"],[3,"ngSubmit","formGroup"],[1,"custom-item"],["position","stacked"],["formControlName","cardHolderName","type","text","placeholder","Ingrese nombre completo"],["class","error-message",4,"ngIf"],[1,"card-type-selector"],["formControlName","type","mode","ios"],["value","credit"],["value","debit"],["formControlName","lastFourDigits","type","text","maxlength","4","placeholder","Ingrese los \xfaltimos 4 d\xedgitos"],["formControlName","expirationDate","type","text","placeholder","MM/YY"],[1,"button-group"],[1,"cancel-button",3,"click"],["name","close-outline"],["type","submit",1,"add-button",3,"disabled"],["name","add-outline"],[1,"error-message"]],template:function(o,i){1&o&&(t.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),t.nrm(3,"ion-back-button",2),t.k0s(),t.j41(4,"ion-title"),t.EFF(5,"M\xe9todos de Pago"),t.k0s()()(),t.j41(6,"ion-content"),t.DNE(7,y,1,0,"ion-spinner",3)(8,u,2,1,"div",4),t.j41(9,"ion-fab",5)(10,"ion-fab-button",6),t.bIt("click",function(){return i.showAddPaymentMethodModal()}),t.nrm(11,"ion-icon",7),t.k0s()()(),t.j41(12,"ion-modal",8),t.bIt("didDismiss",function(){return i.isAddPaymentMethodModalOpen=!1}),t.DNE(13,n,55,9,"ng-template"),t.k0s(),t.nrm(14,"ion-loading",9),t.j41(15,"div",10)(16,"div",11),t.nrm(17,"ion-icon",12),t.k0s(),t.j41(18,"h3"),t.EFF(19,"\xa1Tarjeta registrada exitosamente!"),t.k0s(),t.j41(20,"p"),t.EFF(21,"Tu nuevo m\xe9todo de pago ha sido agregado."),t.k0s()()),2&o&&(t.R7$(7),t.Y8G("ngIf",i.isLoading),t.R7$(),t.Y8G("ngIf",!i.isLoading),t.R7$(4),t.Y8G("isOpen",i.isAddPaymentMethodModalOpen),t.R7$(2),t.Y8G("isOpen",i.isLoading),t.R7$(),t.AVh("show",i.showSuccessMessage))},dependencies:[_.Sq,_.bT,l.qT,l.BC,l.cb,l.tU,l.j4,l.JD,r.Jm,r.QW,r.b_,r.ZB,r.W9,r.Q8,r.YW,r.eU,r.iq,r.$w,r.uz,r.he,r.rQ,r.Gp,r.eP,r.w2,r.BC,r.ai,r.Sb,r.Je,r.Gw,r.el],styles:['@import"https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap";[_nghost-%COMP%]{--ion-font-family: "Roboto", sans-serif}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background: transparent;--border-width: 0}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600;color:var(--ion-color-primary)}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-back-button[_ngcontent-%COMP%]{--color: var(--ion-color-primary)}ion-content[_ngcontent-%COMP%]{--background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);--ion-text-color: var(--ion-color-dark)}.payment-methods-container[_ngcontent-%COMP%]{padding:16px}.payment-card[_ngcontent-%COMP%]{margin-bottom:20px;border-radius:15px;overflow:hidden;box-shadow:0 10px 20px #0000001a}.card-content[_ngcontent-%COMP%]{position:relative;padding:20px;height:200px;display:flex;flex-direction:column;justify-content:space-between}.card-background[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(135deg,#667eea,#764ba2);opacity:.8;z-index:0}.card-info[_ngcontent-%COMP%]{position:relative;z-index:1;color:#fff}.card-type[_ngcontent-%COMP%]{margin-bottom:10px}.card-number[_ngcontent-%COMP%]{font-size:22px;letter-spacing:2px;margin-bottom:20px}.card-details[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.card-holder[_ngcontent-%COMP%], .card-expiry[_ngcontent-%COMP%]{display:flex;flex-direction:column}.label[_ngcontent-%COMP%]{font-size:12px;text-transform:uppercase;opacity:.7}.value[_ngcontent-%COMP%]{font-size:16px;font-weight:700}.card-actions[_ngcontent-%COMP%]{position:absolute;top:10px;right:10px;z-index:2}.card-actions[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--color: white}ion-chip[_ngcontent-%COMP%]{--background: rgba(255, 255, 255, .2);--color: white}ion-fab-button[_ngcontent-%COMP%]{--background: linear-gradient(135deg, var(--ion-color-primary), var(--ion-color-primary-shade));--background-activated: var(--ion-color-primary-shade);--background-hover: var(--ion-color-primary-tint);--box-shadow: 0 4px 16px rgba(var(--ion-color-primary-rgb), .4);transition:all .3s ease}ion-fab-button[_ngcontent-%COMP%]::part(native){box-shadow:0 4px 16px rgba(var(--ion-color-primary-rgb),.4)}ion-fab-button[_ngcontent-%COMP%]:active::part(native){box-shadow:0 2px 8px rgba(var(--ion-color-primary-rgb),.3)}ion-fab-button[_ngcontent-%COMP%]:active{transform:scale(.95)}@media (min-width: 768px){.payment-methods-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:24px}.add-payment-method-modal[_ngcontent-%COMP%]{--width: 80%;--max-width: 600px}}@keyframes _ngcontent-%COMP%_fadeInUp{0%{opacity:0;transform:translate3d(0,30px,0)}to{opacity:1;transform:translateZ(0)}}.animate__fadeInUp[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeInUp .5s ease-out}@keyframes _ngcontent-%COMP%_bounceIn{0%,20%,40%,60%,80%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:scale3d(.3,.3,.3)}20%{transform:scale3d(1.1,1.1,1.1)}40%{transform:scale3d(.9,.9,.9)}60%{opacity:1;transform:scale3d(1.03,1.03,1.03)}80%{transform:scale3d(.97,.97,.97)}to{opacity:1;transform:scaleZ(1)}}.animate__bounceIn[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_bounceIn .8s}.add-payment-method-modal[_ngcontent-%COMP%]{--background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)}.add-payment-method-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{background:#ffffffe6;border-radius:20px;box-shadow:0 8px 24px #0000001a;padding:24px}.add-payment-method-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .card-preview[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);border-radius:16px;padding:24px;color:#fff;margin-bottom:30px;box-shadow:0 10px 20px #0003;position:relative;overflow:hidden;transition:all .3s ease}.add-payment-method-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .card-preview[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 15px 30px #0000004d}.add-payment-method-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .card-preview[_ngcontent-%COMP%]:before{content:"";position:absolute;top:-50%;left:-50%;width:200%;height:200%;background:#ffffff1a;transform:rotate(30deg)}.add-payment-method-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .card-preview[_ngcontent-%COMP%]   .chip[_ngcontent-%COMP%]{width:50px;height:40px;background:linear-gradient(135deg,gold,#fa0);border-radius:8px;margin-bottom:20px;position:relative;overflow:hidden}.add-payment-method-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .card-preview[_ngcontent-%COMP%]   .chip[_ngcontent-%COMP%]:after{content:"";position:absolute;top:50%;left:-5px;right:-5px;height:20px;background:#ffffff1a;transform:translateY(-50%)}.add-payment-method-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .card-preview[_ngcontent-%COMP%]   .card-type-icon[_ngcontent-%COMP%]{position:absolute;top:24px;right:24px;font-size:24px;opacity:.8}.add-payment-method-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .card-preview[_ngcontent-%COMP%]   .card-number[_ngcontent-%COMP%]{font-size:22px;letter-spacing:2px;margin-bottom:20px;text-shadow:1px 1px 2px rgba(0,0,0,.1)}.add-payment-method-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .card-preview[_ngcontent-%COMP%]   .card-info[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.add-payment-method-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .card-preview[_ngcontent-%COMP%]   .card-info[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:10px;text-transform:uppercase;opacity:.7;display:block;margin-bottom:5px}.add-payment-method-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .card-preview[_ngcontent-%COMP%]   .card-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;font-weight:500;text-shadow:1px 1px 2px rgba(0,0,0,.1)}.add-payment-method-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .card-preview[_ngcontent-%COMP%]   .card-type[_ngcontent-%COMP%]{position:absolute;bottom:24px;right:24px;font-size:14px;font-weight:600;text-transform:uppercase;opacity:.8}.add-payment-method-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--padding-start: 0;--inner-padding-end: 0;--min-height: 65px;margin-bottom:16px}.add-payment-method-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   ion-item.item-has-focus[_ngcontent-%COMP%]{--highlight-height: 2px}.add-payment-method-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{color:var(--ion-color-medium);font-size:14px;transform:translateY(-12px) scale(.75);transition:all .2s ease}.add-payment-method-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{--padding-start: 0;--padding-top: 20px;font-size:16px;color:var(--ion-color-dark)}.add-payment-method-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   ion-item.item-has-value[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%], .add-payment-method-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   ion-item.item-has-focus[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{color:var(--ion-color-primary);transform:translateY(-25px) scale(.75)}.add-payment-method-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .card-type-selector[_ngcontent-%COMP%]{margin-bottom:16px}.add-payment-method-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .card-type-selector[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]{background:var(--ion-color-light);border-radius:8px}.add-payment-method-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .card-type-selector[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]{--color: var(--ion-color-medium);--color-checked: var(--ion-color-primary);--indicator-color: var(--ion-color-primary);min-height:40px}.add-payment-method-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .card-type-selector[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-size:14px;text-transform:none}.add-payment-method-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-top:20px}.add-payment-method-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{width:48%;height:44px;font-size:14px;font-weight:500;--border-radius: 8px}.card-type-selector[_ngcontent-%COMP%]   ion-segment-button[value=credit][_ngcontent-%COMP%]{--color-checked: var(--ion-color-primary)}.card-type-selector[_ngcontent-%COMP%]   ion-segment-button[value=credit][_ngcontent-%COMP%]::part(indicator-background){background:var(--ion-color-primary-tint)}.card-type-selector[_ngcontent-%COMP%]   ion-segment-button[value=debit][_ngcontent-%COMP%]{--color-checked: var(--ion-color-success)}.card-type-selector[_ngcontent-%COMP%]   ion-segment-button[value=debit][_ngcontent-%COMP%]::part(indicator-background){background:var(--ion-color-success-tint)}@keyframes _ngcontent-%COMP%_gradientBG{0%{background-position:0% 50%}50%{background-position:100% 50%}to{background-position:0% 50%}}ion-card.payment-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 12px 24px #00000026}ion-input[_ngcontent-%COMP%], ion-select[_ngcontent-%COMP%], ion-textarea[_ngcontent-%COMP%]{--placeholder-color: var(--ion-color-medium);--placeholder-opacity: .7}ion-item.item-has-focus[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{display:none}.payment-methods-container[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeInUp .5s ease-out forwards;opacity:0;transform:translateY(20px)}@keyframes _ngcontent-%COMP%_fadeInUp{to{opacity:1;transform:translateY(0)}}ion-fab-button[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_bounceIn .5s ease-out}@keyframes _ngcontent-%COMP%_bounceIn{0%{transform:scale(.1);opacity:0}60%{transform:scale(1.2);opacity:1}to{transform:scale(1)}}.success-message[_ngcontent-%COMP%]{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%) scale(.7);background:#fff;padding:30px;border-radius:20px;box-shadow:0 10px 30px #0000001a;text-align:center;opacity:0;visibility:hidden;transition:all .3s ease;z-index:9999}.success-message.show[_ngcontent-%COMP%]{opacity:1;visibility:visible;transform:translate(-50%,-50%) scale(1)}.success-message[_ngcontent-%COMP%]   .success-icon[_ngcontent-%COMP%]{font-size:60px;color:var(--ion-color-success);margin-bottom:20px}.success-message[_ngcontent-%COMP%]   .success-icon[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_scaleIn .5s ease-out}.success-message[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:24px;color:var(--ion-color-dark);margin-bottom:10px}.success-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;color:var(--ion-color-medium)}@keyframes _ngcontent-%COMP%_scaleIn{0%{transform:scale(0)}60%{transform:scale(1.2)}to{transform:scale(1)}}.payment-methods-container[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideInUp .5s ease-out forwards;opacity:0;transform:translateY(30px)}.payment-methods-container[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]:nth-child(1){animation-delay:.1s}.payment-methods-container[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]:nth-child(2){animation-delay:.2s}.payment-methods-container[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]:nth-child(3){animation-delay:.3s}.payment-methods-container[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]:nth-child(4){animation-delay:.4s}.payment-methods-container[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]:nth-child(5){animation-delay:.5s}.payment-methods-container[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]:nth-child(6){animation-delay:.6s}.payment-methods-container[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]:nth-child(7){animation-delay:.7s}.payment-methods-container[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]:nth-child(8){animation-delay:.8s}.payment-methods-container[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]:nth-child(9){animation-delay:.9s}.payment-methods-container[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]:nth-child(10){animation-delay:1s}@keyframes _ngcontent-%COMP%_slideInUp{0%{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}.custom-item[_ngcontent-%COMP%]{--padding-start: 0;--inner-padding-end: 0;--min-height: 72px;margin-bottom:16px}.custom-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{color:var(--ion-color-medium);font-size:16px;transform:translateY(8px);transition:all .2s ease}.custom-item[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{--padding-start: 0;font-size:18px;--placeholder-color: var(--ion-color-medium);--placeholder-opacity: .7}.custom-item.item-has-focus[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{color:var(--ion-color-primary);transform:translateY(0)}.error-message[_ngcontent-%COMP%]{color:var(--ion-color-danger);font-size:14px;margin-top:-12px;margin-bottom:16px}.card-type-selector[_ngcontent-%COMP%]{margin-bottom:20px}.card-type-selector[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]{--background: var(--ion-color-light);border-radius:8px}.card-type-selector[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]{--color: var(--ion-color-medium);--color-checked: var(--ion-color-primary);--indicator-color: var(--ion-color-primary);min-height:44px}.card-type-selector[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-size:16px;text-transform:none}.button-group[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-top:30px}.button-group[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--border-radius: 12px;--box-shadow: 0 4px 10px rgba(0, 0, 0, .1);overflow:hidden;position:relative;transition:all .3s ease}.button-group[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;width:100%;height:100%;background:linear-gradient(45deg,#ffffff1a,#fff3);opacity:0;transition:opacity .3s ease}.button-group[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]:hover:before{opacity:1}.button-group[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:8px}.button-group[_ngcontent-%COMP%]   ion-button.cancel-button[_ngcontent-%COMP%]{--background: var(--ion-color-medium);--color: var(--ion-color-light)}.button-group[_ngcontent-%COMP%]   ion-button.cancel-button[_ngcontent-%COMP%]:hover{--background: var(--ion-color-medium-shade)}.button-group[_ngcontent-%COMP%]   ion-button.add-button[_ngcontent-%COMP%]{--background: var(--ion-color-primary);--color: var(--ion-color-light)}.button-group[_ngcontent-%COMP%]   ion-button.add-button[_ngcontent-%COMP%]:hover:not(:disabled){--background: var(--ion-color-primary-shade)}.button-group[_ngcontent-%COMP%]   ion-button.add-button[_ngcontent-%COMP%]:disabled{opacity:.7}.button-group[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]:active{transform:scale(.98)}@keyframes _ngcontent-%COMP%_pulse{0%{box-shadow:0 0 rgba(var(--ion-color-primary-rgb),.4)}70%{box-shadow:0 0 0 10px rgba(var(--ion-color-primary-rgb),0)}to{box-shadow:0 0 rgba(var(--ion-color-primary-rgb),0)}}.add-button[_ngcontent-%COMP%]:not(:disabled){animation:_ngcontent-%COMP%_pulse 2s infinite}.loading-spinner[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100%}']}),m})()}];let k=(()=>{var a;class m{}return(a=m).\u0275fac=function(o){return new(o||a)},a.\u0275mod=t.$C({type:a}),a.\u0275inj=t.G2t({imports:[p.iI.forChild(F),p.iI]}),m})(),E=(()=>{var a;class m{}return(a=m).\u0275fac=function(o){return new(o||a)},a.\u0275mod=t.$C({type:a}),a.\u0275inj=t.G2t({imports:[_.MD,l.YN,l.X1,r.bv,k]}),m})()},8287:(x,P,d)=>{d.d(P,{f:()=>b});var _=d(467),l=d(7673),r=d(6354),p=d(5558),h=d(6697),t=d(3953),C=d(6340),O=d(1182),y=d(4964);let b=(()=>{var u;class f{constructor(e,n,M){this.firestore=e,this.afAuth=n,this.router=M}getRandomDriver(){return this.firestore.collection("drivers").valueChanges({idField:"id"}).pipe((0,r.T)(e=>e[Math.floor(Math.random()*e.length)]))}getAllDrivers(){return this.firestore.collection("drivers").valueChanges({idField:"id"})}getUserTrips(e){return this.firestore.collection("trips",n=>n.where("userId","==",e).orderBy("date","desc")).valueChanges({idField:"id"})}getUserProfile(e){return this.firestore.collection("active_users").doc(e).valueChanges().pipe((0,r.T)(n=>n?{createdAt:n.createdAt,email:n.email,name:n.name||"",phone:n.phone||"",profileImage:n.profileImage||"",username:n.username||""}:null))}setUserProfile(e,n){return this.firestore.collection("active_users").doc(e).set(n,{merge:!0})}updateUserProfile(e,n){return this.firestore.collection("active_users").doc(e).set(n,{merge:!0})}getCurrentUserId(){return this.afAuth.authState.pipe((0,r.T)(e=>e?e.uid:null))}getPaymentMethods(){return console.log("Iniciando getPaymentMethods"),this.afAuth.authState.pipe((0,p.n)(e=>e?(console.log("Usuario autenticado, ID:",e.uid),this.firestore.collection(`users/${e.uid}/cards`).valueChanges({idField:"id"}).pipe((0,r.T)(n=>(console.log("M\xe9todos de pago obtenidos (longitud):",n.length),console.log("M\xe9todos de pago obtenidos (contenido):",JSON.stringify(n)),n)))):(console.log("No hay usuario autenticado en getPaymentMethods"),(0,l.of)([]))))}addPaymentMethod(e){return this.afAuth.authState.pipe((0,h.s)(1),(0,p.n)(n=>{if(!n)throw new Error("No user authenticated");return this.firestore.collection(`users/${n.uid}/cards`).add(e)}),(0,r.T)(()=>{}))}updatePaymentMethod(e,n){return this.afAuth.authState.pipe((0,h.s)(1),(0,p.n)(M=>{if(!M)throw new Error("No user authenticated");return this.firestore.doc(`users/${M.uid}/cards/${e}`).update(n)}))}deletePaymentMethod(e){return this.afAuth.authState.pipe((0,h.s)(1),(0,p.n)(n=>{if(!n)throw new Error("No user authenticated");return this.firestore.doc(`users/${n.uid}/cards/${e}`).delete()}))}getDrivers(){return this.firestore.collection("drivers").valueChanges().pipe((0,r.T)(e=>e))}logout(){var e=this;return(0,_.A)(function*(){try{yield e.afAuth.signOut(),localStorage.removeItem("user"),localStorage.removeItem("username"),e.router.navigate(["/login"])}catch(n){throw console.error("Error durante el cierre de sesi\xf3n:",n),n}})()}getTripHistory(){return this.afAuth.authState.pipe((0,p.n)(e=>e?this.firestore.collection(`users/${e.uid}/trips`,n=>n.orderBy("date","desc")).valueChanges({idField:"id"}).pipe((0,h.s)(1),(0,r.T)(n=>(console.log("Historial de viajes obtenido:",n),n))):(0,l.of)([])))}}return(u=f).\u0275fac=function(e){return new(e||u)(t.KVO(C.Qe),t.KVO(O.DS),t.KVO(y.Ix))},u.\u0275prov=t.jDH({token:u,factory:u.\u0275fac,providedIn:"root"}),f})()}}]);